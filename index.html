<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>SANTOS & VIEIRA | MONITOR v5.0</title>
    <style>
        /* RESET E CORES FRIAS */
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { 
            background: #0a0a0a; 
            color: #d1d1d1; 
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        /* HEADER DISCRETO */
        header {
            padding: 10px 20px;
            background: #000;
            border-bottom: 1px solid #222;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .logo { font-weight: bold; letter-spacing: 1px; font-size: 14px; color: #eee; }
        #clock { font-family: monospace; font-size: 14px; color: #666; }

        main { display: flex; flex: 1; overflow: hidden; }

        /* SIDEBAR MINIMALISTA */
        .sidebar {
            width: 240px;
            background: #0d0d0d;
            border-right: 1px solid #222;
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 20px;
            overflow-y: auto;
        }

        .section-label { 
            font-size: 10px; 
            text-transform: uppercase; 
            color: #444; 
            letter-spacing: 2px; 
            margin-bottom: 8px;
            font-weight: bold;
        }

        input, select, button {
            background: #151515;
            border: 1px solid #333;
            color: #ccc;
            padding: 8px 12px;
            font-size: 12px;
            width: 100%;
            outline: none;
            transition: all 0.2s;
        }
        input:focus { border-color: #555; background: #1a1a1a; }
        
        .btn-primary { 
            background: #222; 
            cursor: pointer; 
            border: none;
            color: #aaa;
        }
        .btn-primary:hover { background: #333; color: #fff; }

        /* LISTA DE CANAIS LIMPA */
        .channel-list { list-style: none; }
        .channel-item {
            padding: 6px 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 13px;
            border-bottom: 1px solid #1a1a1a;
            cursor: pointer;
            color: #888;
        }
        .channel-item:hover { color: #fff; }
        .del-btn { color: #444; border: none; background: none; width: auto; cursor: pointer; }
        .del-btn:hover { color: #ff4444; }

        /* VIEWPORT DAS LIVES */
        .main-view { 
            flex: 1; 
            display: grid; 
            grid-template-columns: 1fr; 
            gap: 1px; /* Linha fina separando as lives */
            background: #222; /* Cor da borda entre os players */
            overflow-y: auto;
        }

        .player-container {
            background: #000;
            display: flex;
            height: 500px; /* Altura fixa para manter o foco */
            position: relative;
        }

        .video-box { flex: 3; background: #000; }
        .chat-box { flex: 1; background: #080808; border-left: 1px solid #222; }
        
        iframe { width: 100%; height: 100%; border: none; }

        /* IA CHAT REDUZIDO */
        #chatOutput {
            height: 120px;
            font-size: 11px;
            background: #050505;
            padding: 10px;
            border: 1px solid #1a1a1a;
            overflow-y: auto;
            color: #666;
            margin-bottom: 5px;
        }
    </style>
</head>
<body onload="initSystem()">

<header>
    <div class="logo">SANTOS & VIEIRA <span style="color: #444;">// MONITOR</span></div>
    <div id="clock">00:00:00</div>
</header>

<main>
    <div class="sidebar">
        <div>
            <div class="section-label">Neural Assistant</div>
            <div id="chatOutput">System Ready...</div>
            <input id="aiInput" placeholder="Command..." onkeydown="if(event.key==='Enter') sendToAI()">
        </div>

        <div>
            <div class="section-label">Add Stream</div>
            <input id="quickInput" placeholder="User ID" style="margin-bottom: 5px;">
            <div style="display: flex; gap: 5px;">
                <button class="btn-primary" onclick="addLive(document.getElementById('quickInput').value, 'twitch')">Twitch</button>
                <button class="btn-primary" onclick="addLive(document.getElementById('quickInput').value, 'kick')">Kick</button>
            </div>
        </div>

        <div>
            <div class="section-label">Stored Channels</div>
            <div id="channelList" class="channel-list"></div>
        </div>
        
        <button class="btn-primary" style="margin-top: auto; font-size: 10px;" onclick="location.reload()">Reset Session</button>
    </div>

    <div id="mainView" class="main-view">
        </div>
</main>

<script>
    // IA - MANTENDO A LÓGICA DO SEU OLLAMA
    async function sendToAI() {
        const input = document.getElementById('aiInput');
        const output = document.getElementById('chatOutput');
        if(!input.value) return;
        output.innerHTML += `<div style="color:#aaa; margin-top:4px;">> ${input.value}</div>`;
        try {
            const response = await fetch('http://localhost:11434/api/generate', {
                method: 'POST',
                body: JSON.stringify({ model: 'tinyllama', prompt: input.value, stream: false })
            });
            const data = await response.json();
            output.innerHTML += `<div style="color:#666; margin-top:4px;">AI: ${data.response}</div>`;
        } catch (e) {
            output.innerHTML += `<div style="color:#442222;">Offline</div>`;
        }
        input.value = "";
        output.scrollTop = output.scrollHeight;
    }

    let favorites = JSON.parse(localStorage.getItem('sv_favs_v3')) || [
        { name: "Jon Vlogs", id: "jonvlogs", type: "twitch" },
        { name: "Loud Coringa", id: "loud_coringa", type: "twitch" }
    ];

    function initSystem() {
        renderFavs();
        setInterval(() => document.getElementById('clock').innerText = new Date().toLocaleTimeString(), 1000);
    }

    function renderFavs() {
        const container = document.getElementById('channelList');
        container.innerHTML = "";
        favorites.forEach((fav, index) => {
            container.innerHTML += `
                <div class="channel-item" onclick="addLive('${fav.id}', '${fav.type}')">
                    <span>${fav.name}</span>
                    <button class="del-btn" onclick="event.stopPropagation(); deleteFav(${index})">×</button>
                </div>`;
        });
    }

    function deleteFav(index) {
        favorites.splice(index, 1);
        localStorage.setItem('sv_favs_v3', JSON.stringify(favorites));
        renderFavs();
    }

    function addLive(val, type) {
        if(!val) return;
        const mainView = document.getElementById('mainView');
        const host = window.location.hostname || "localhost";
        const container = document.createElement('div');
        container.className = 'player-container';
        
        let videoUrl, chatUrl;
        if(type === 'twitch') {
            videoUrl = `https://player.twitch.tv/?channel=${val}&parent=${host}`;
            chatUrl = `https://www.twitch.tv/embed/${val}/chat?parent=${host}&darkpopout`;
        } else {
            videoUrl = `https://player.kick.com/${val}`;
            chatUrl = `https://kick.com/chat/${val}`;
        }

        container.innerHTML = `
            <button onclick="this.parentElement.remove()" style="position:absolute; right:10px; top:10px; z-index:100; width:25px; background:rgba(0,0,0,0.5); border:1px solid #333; cursor:pointer; color:#fff;">×</button>
            <div class="video-box">
                <iframe src="${videoUrl}" allow="autoplay; fullscreen"></iframe>
            </div>
            <div class="chat-box">
                <iframe src="${chatUrl}"></iframe>
            </div>
        `;
        mainView.appendChild(container);
    }
</script>
</body>
</html>
